# GCP í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤ ì´ìš© ê³„íš

## ëª©í‘œ
Google Cloud Platformì˜ ë¬´ë£Œ í‹°ì–´ì™€ ì €ë¹„ìš© ì„œë¹„ìŠ¤ë¥¼ í™œìš©í•œ ë¸”ë¡œê·¸ ìš´ì˜

---

## GCP ì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜

### ì „ì²´ êµ¬ì„±ë„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Google Cloud Platform                                      â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Cloud CDN                                            â”‚ â”‚
â”‚  â”‚  - Global edge caching                                â”‚ â”‚
â”‚  â”‚  - SSL/TLS termination                                â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                            â”‚                                â”‚
â”‚                            â–¼                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Cloud Load Balancing                                 â”‚ â”‚
â”‚  â”‚  - HTTPS Load Balancer                                â”‚ â”‚
â”‚  â”‚  - Custom domain: yourblog.com                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                            â”‚                                â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚              â–¼                           â–¼                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Cloud Run           â”‚   â”‚ Cloud Run                â”‚    â”‚
â”‚  â”‚ (Frontend)          â”‚   â”‚ (Backend)                â”‚    â”‚
â”‚  â”‚ - Next.js           â”‚   â”‚ - NestJS                 â”‚    â”‚
â”‚  â”‚ - Auto-scaling      â”‚   â”‚ - Auto-scaling           â”‚    â”‚
â”‚  â”‚ - Min: 0            â”‚   â”‚ - Min: 0                 â”‚    â”‚
â”‚  â”‚ - Max: 10           â”‚   â”‚ - Max: 5                 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                          â”‚                  â”‚
â”‚                                          â–¼                  â”‚
â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚                          â”‚ Cloud SQL                â”‚       â”‚
â”‚                          â”‚ - PostgreSQL 15          â”‚       â”‚
â”‚                          â”‚ - db-f1-micro (ë¬´ë£Œ)     â”‚       â”‚
â”‚                          â”‚ - 10GB storage           â”‚       â”‚
â”‚                          â”‚ - Private IP             â”‚       â”‚
â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Cloud Storage                                        â”‚ â”‚
â”‚  â”‚  - Blog images bucket (Public)                        â”‚ â”‚
â”‚  â”‚  - CDN enabled                                        â”‚ â”‚
â”‚  â”‚  - Lifecycle policy (90ì¼ í›„ Archive)                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Secret Manager                                       â”‚ â”‚
â”‚  â”‚  - Database credentials                               â”‚ â”‚
â”‚  â”‚  - JWT secrets                                        â”‚ â”‚
â”‚  â”‚  - API keys                                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Container Registry / Artifact Registry               â”‚ â”‚
â”‚  â”‚  - Docker images                                      â”‚ â”‚
â”‚  â”‚  - Version management                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Cloud Logging & Monitoring                           â”‚ â”‚
â”‚  â”‚  - Application logs                                   â”‚ â”‚
â”‚  â”‚  - Metrics & Alerts                                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 1. Cloud Run (ì»´í“¨íŒ…)

### 1.1. ì„œë¹„ìŠ¤ ê°œìš”
- **Serverless ì»¨í…Œì´ë„ˆ í”Œë«í¼**
- ì‚¬ìš©í•œ ë§Œí¼ë§Œ ë¹„ìš© ì§€ë¶ˆ
- ìë™ ìŠ¤ì¼€ì¼ë§ (0 â†’ N)
- HTTPS ìë™ ì œê³µ

### 1.2. ë¬´ë£Œ í‹°ì–´
- **CPU ì‹œê°„**: 180,000 vCPU-ì´ˆ/ì›” (50ì‹œê°„)
- **ë©”ëª¨ë¦¬**: 360,000 GiB-ì´ˆ/ì›”
- **ìš”ì²­**: 2,000,000 ìš”ì²­/ì›”
- **ë„¤íŠ¸ì›Œí¬ Egress**: 1GB/ì›” (ë¶ë¯¸)

### 1.3. Frontend ì„¤ì • (Next.js)

```yaml
# Frontend Cloud Run ì„¤ì •
apiVersion: serving.knative.dev/v1
kind: Service
metadata:
  name: blog-frontend
  labels:
    cloud.googleapis.com/location: asia-northeast3
spec:
  template:
    metadata:
      annotations:
        # Auto-scaling ì„¤ì •
        autoscaling.knative.dev/minScale: "0"
        autoscaling.knative.dev/maxScale: "10"
        # ë¦¬ì†ŒìŠ¤ í• ë‹¹
        run.googleapis.com/cpu-throttling: "true"
    spec:
      containerConcurrency: 80
      timeoutSeconds: 300
      containers:
      - image: gcr.io/YOUR_PROJECT_ID/blog-frontend:latest
        ports:
        - name: http1
          containerPort: 3000
        env:
        - name: NODE_ENV
          value: "production"
        - name: NEXT_PUBLIC_API_URL
          value: "https://api.yourblog.com"
        resources:
          limits:
            cpu: "1000m"
            memory: "512Mi"
```

**ë¹„ìš© ì˜ˆìƒ (ì›” 5,000 ë°©ë¬¸ì)**:
- CPU: ~30,000 vCPU-ì´ˆ = **ë¬´ë£Œ**
- ë©”ëª¨ë¦¬: ~60,000 GiB-ì´ˆ = **ë¬´ë£Œ**
- ìš”ì²­: ~15,000 ìš”ì²­ = **ë¬´ë£Œ**
- **ì´ ë¹„ìš©: $0**

### 1.4. Backend ì„¤ì • (NestJS)

```yaml
# Backend Cloud Run ì„¤ì •
apiVersion: serving.knative.dev/v1
kind: Service
metadata:
  name: blog-backend
  labels:
    cloud.googleapis.com/location: asia-northeast3
spec:
  template:
    metadata:
      annotations:
        autoscaling.knative.dev/minScale: "0"
        autoscaling.knative.dev/maxScale: "5"
        # Cloud SQL ì—°ê²°
        run.googleapis.com/cloudsql-instances: "YOUR_PROJECT_ID:asia-northeast3:blog-db"
    spec:
      containerConcurrency: 80
      timeoutSeconds: 300
      containers:
      - image: gcr.io/YOUR_PROJECT_ID/blog-backend:latest
        ports:
        - name: http1
          containerPort: 3002
        env:
        - name: NODE_ENV
          value: "production"
        - name: DATABASE_HOST
          value: "/cloudsql/YOUR_PROJECT_ID:asia-northeast3:blog-db"
        - name: DATABASE_NAME
          valueFrom:
            secretKeyRef:
              name: database-name
              key: latest
        - name: DATABASE_USER
          valueFrom:
            secretKeyRef:
              name: database-user
              key: latest
        - name: DATABASE_PASSWORD
          valueFrom:
            secretKeyRef:
              name: database-password
              key: latest
        - name: JWT_SECRET
          valueFrom:
            secretKeyRef:
              name: jwt-secret
              key: latest
        resources:
          limits:
            cpu: "1000m"
            memory: "512Mi"
```

**ë¹„ìš© ì˜ˆìƒ (ì›” 5,000 ë°©ë¬¸ì)**:
- CPU: ~20,000 vCPU-ì´ˆ = **ë¬´ë£Œ**
- ë©”ëª¨ë¦¬: ~40,000 GiB-ì´ˆ = **ë¬´ë£Œ**
- ìš”ì²­: ~10,000 ìš”ì²­ = **ë¬´ë£Œ**
- **ì´ ë¹„ìš©: $0**

### 1.5. Cloud Run ëª…ë ¹ì–´

```bash
# Frontend ë°°í¬
gcloud run deploy blog-frontend \
  --image gcr.io/YOUR_PROJECT_ID/blog-frontend:latest \
  --platform managed \
  --region asia-northeast3 \
  --allow-unauthenticated \
  --min-instances 0 \
  --max-instances 10 \
  --cpu 1 \
  --memory 512Mi \
  --timeout 300 \
  --set-env-vars NODE_ENV=production,NEXT_PUBLIC_API_URL=https://api.yourblog.com

# Backend ë°°í¬ (Cloud SQL ì—°ê²°)
gcloud run deploy blog-backend \
  --image gcr.io/YOUR_PROJECT_ID/blog-backend:latest \
  --platform managed \
  --region asia-northeast3 \
  --allow-unauthenticated \
  --min-instances 0 \
  --max-instances 5 \
  --cpu 1 \
  --memory 512Mi \
  --timeout 300 \
  --add-cloudsql-instances YOUR_PROJECT_ID:asia-northeast3:blog-db \
  --set-secrets DATABASE_PASSWORD=database-password:latest,JWT_SECRET=jwt-secret:latest

# ì„œë¹„ìŠ¤ í™•ì¸
gcloud run services list

# ë¡œê·¸ í™•ì¸
gcloud run logs read blog-backend --limit 50
```

---

## 2. Cloud SQL (ë°ì´í„°ë² ì´ìŠ¤)

### 2.1. ì„œë¹„ìŠ¤ ê°œìš”
- **ê´€ë¦¬í˜• PostgreSQL**
- ìë™ ë°±ì—…, íŒ¨ì¹˜
- HA (High Availability) ì§€ì›

### 2.2. ë¬´ë£Œ í‹°ì–´ (90ì¼ê°„)
- **ì¸ìŠ¤í„´ìŠ¤ íƒ€ì…**: db-f1-micro (0.6GB RAM, ê³µìœ  CPU)
- **ìŠ¤í† ë¦¬ì§€**: 10GB HDD
- **ë°±ì—…**: 7ì¼ ë³´ê´€
- **ë¦¬ì „**: asia-northeast3 (ì„œìš¸) ë˜ëŠ” us-central1 (ì•„ì´ì˜¤ì™€)

**ì£¼ì˜**: ë¬´ë£Œ í‹°ì–´ëŠ” 90ì¼ í›„ ì¢…ë£Œë˜ì§€ë§Œ, db-f1-microëŠ” ê³„ì† ì €ë ´í•¨

### 2.3. ë¹„ìš© ì˜ˆìƒ (ìœ ë£Œ ì „í™˜ í›„)

**db-f1-micro (ì„œìš¸ ë¦¬ì „)**:
- ì¸ìŠ¤í„´ìŠ¤: ~$7.67/ì›”
- ìŠ¤í† ë¦¬ì§€ (10GB HDD): ~$1.70/ì›”
- ë°±ì—… (10GB): ~$0.80/ì›”
- **ì´ ë¹„ìš©: ~$10/ì›”**

**db-g1-small (ë” ì•ˆì •ì , 1.7GB RAM)**:
- ì¸ìŠ¤í„´ìŠ¤: ~$25.55/ì›”
- ìŠ¤í† ë¦¬ì§€ (10GB SSD): ~$1.70/ì›”
- **ì´ ë¹„ìš©: ~$27/ì›”**

### 2.4. Cloud SQL ìƒì„±

```bash
# PostgreSQL ì¸ìŠ¤í„´ìŠ¤ ìƒì„± (ë¬´ë£Œ í‹°ì–´)
gcloud sql instances create blog-db \
  --database-version=POSTGRES_15 \
  --tier=db-f1-micro \
  --region=asia-northeast3 \
  --storage-type=HDD \
  --storage-size=10GB \
  --storage-auto-increase \
  --backup \
  --backup-start-time=03:00 \
  --maintenance-window-day=SUN \
  --maintenance-window-hour=04 \
  --database-flags=max_connections=100

# ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±
gcloud sql databases create blog \
  --instance=blog-db

# ì‚¬ìš©ì ìƒì„±
gcloud sql users create bloguser \
  --instance=blog-db \
  --password=YOUR_SECURE_PASSWORD

# Private IP ì„¤ì • (Cloud Run ì—°ê²°ìš©)
gcloud sql instances patch blog-db \
  --network=projects/YOUR_PROJECT_ID/global/networks/default \
  --no-assign-ip
```

### 2.5. ë°±ì—… ë° ë³µêµ¬

```bash
# ìˆ˜ë™ ë°±ì—… ìƒì„±
gcloud sql backups create \
  --instance=blog-db \
  --description="Manual backup before migration"

# ë°±ì—… ëª©ë¡ í™•ì¸
gcloud sql backups list --instance=blog-db

# ë³µêµ¬
gcloud sql backups restore BACKUP_ID \
  --backup-instance=blog-db \
  --backup-id=BACKUP_RUN_ID
```

### 2.6. ë¹„ìš© ìµœì í™” íŒ

```bash
# ê°œë°œ í™˜ê²½: ì•¼ê°„/ì£¼ë§ ì¸ìŠ¤í„´ìŠ¤ ì¤‘ì§€
gcloud sql instances patch blog-db --activation-policy=NEVER

# í”„ë¡œë•ì…˜ ì¬ì‹œì‘
gcloud sql instances patch blog-db --activation-policy=ALWAYS

# ìŠ¤í† ë¦¬ì§€ ìë™ ì¦ê°€ ë¹„í™œì„±í™” (ë¹„ìš© ì œí•œ)
gcloud sql instances patch blog-db --no-storage-auto-increase
```

---

## 3. Cloud Storage (ì´ë¯¸ì§€ ì €ì¥ì†Œ)

### 3.1. ì„œë¹„ìŠ¤ ê°œìš”
- **ì˜¤ë¸Œì íŠ¸ ìŠ¤í† ë¦¬ì§€**
- ì •ì  íŒŒì¼ í˜¸ìŠ¤íŒ…
- CDN ì—°ë™

### 3.2. ë¬´ë£Œ í‹°ì–´
- **Standard Storage**: 5GB/ì›”
- **Class A ì‘ì—…**: 5,000/ì›” (ì“°ê¸°)
- **Class B ì‘ì—…**: 50,000/ì›” (ì½ê¸°)
- **Egress**: 1GB/ì›” (ë¶ë¯¸), 200MB/ì›” (ì•„ì‹œì•„)

### 3.3. ë¹„ìš© (ìœ ë£Œ)
- **Standard Storage (ì•„ì‹œì•„)**: $0.020/GB/ì›”
- **Nearline (90ì¼ ì´ìƒ)**: $0.010/GB/ì›”
- **Class A ì‘ì—…**: $0.005/1,000
- **Egress (ì•„ì‹œì•„)**: $0.12/GB

**ì˜ˆìƒ ë¹„ìš© (10GB ì´ë¯¸ì§€, ì›” 100GB íŠ¸ë˜í”½)**:
- Storage: $0.20
- Class A: $0.01
- Egress: $12.00
- **ì´ ë¹„ìš©: ~$12/ì›”**

**ìµœì í™”**: Cloud CDN ì‚¬ìš© ì‹œ Egress ë¹„ìš© ì ˆê°

### 3.4. ë²„í‚· ìƒì„±

```bash
# Public ë²„í‚· ìƒì„± (ë¸”ë¡œê·¸ ì´ë¯¸ì§€ìš©)
gcloud storage buckets create gs://YOUR_BUCKET_NAME \
  --location=asia-northeast3 \
  --storage-class=STANDARD \
  --uniform-bucket-level-access

# Public ì•¡ì„¸ìŠ¤ í—ˆìš©
gcloud storage buckets add-iam-policy-binding gs://YOUR_BUCKET_NAME \
  --member=allUsers \
  --role=roles/storage.objectViewer

# CORS ì„¤ì • (í”„ë¡ íŠ¸ì—”ë“œ ì ‘ê·¼ í—ˆìš©)
cat > cors.json <<EOF
[
  {
    "origin": ["https://yourblog.com"],
    "method": ["GET", "HEAD"],
    "responseHeader": ["Content-Type"],
    "maxAgeSeconds": 3600
  }
]
EOF

gcloud storage buckets update gs://YOUR_BUCKET_NAME --cors-file=cors.json

# Lifecycle ì •ì±… (90ì¼ í›„ Nearlineìœ¼ë¡œ ì´ë™)
cat > lifecycle.json <<EOF
{
  "lifecycle": {
    "rule": [
      {
        "action": {"type": "SetStorageClass", "storageClass": "NEARLINE"},
        "condition": {"age": 90}
      }
    ]
  }
}
EOF

gcloud storage buckets update gs://YOUR_BUCKET_NAME --lifecycle-file=lifecycle.json
```

### 3.5. CDN ì—°ë™ (ë¹„ìš© ìµœì í™”)

```bash
# Backend bucket ìƒì„± (Cloud CDNìš©)
gcloud compute backend-buckets create blog-images-backend \
  --gcs-bucket-name=YOUR_BUCKET_NAME \
  --enable-cdn

# URL Map ìƒì„±
gcloud compute url-maps create blog-cdn \
  --default-backend-bucket=blog-images-backend

# CDNì„ í†µí•œ ì´ë¯¸ì§€ ì œê³µ (Egress ë¹„ìš© ì ˆê°)
# https://cdn.yourblog.com/image.jpg
```

**CDN ì‚¬ìš© ì‹œ ë¹„ìš©**:
- **Cache Hit**: $0.04/GB (Egress $0.12/GB ëŒ€ë¹„ 70% ì ˆê°!)
- **Cache Fill**: $0.08/GB (ì²« ìš”ì²­ë§Œ)

---

## 4. Secret Manager (í™˜ê²½ë³€ìˆ˜ ê´€ë¦¬)

### 4.1. ì„œë¹„ìŠ¤ ê°œìš”
- **ì•”í˜¸í™”ëœ í™˜ê²½ë³€ìˆ˜ ì €ì¥**
- ë²„ì „ ê´€ë¦¬
- IAM ê¸°ë°˜ ì ‘ê·¼ ì œì–´

### 4.2. ë¬´ë£Œ í‹°ì–´
- **6ê°œ í™œì„± Secret ë²„ì „**: ë¬´ë£Œ
- **10,000 ì•¡ì„¸ìŠ¤ ì‘ì—…/ì›”**: ë¬´ë£Œ

### 4.3. ë¹„ìš© (ì´ˆê³¼ ì‹œ)
- **í™œì„± ë²„ì „**: $0.06/ë²„ì „/ì›”
- **ì•¡ì„¸ìŠ¤ ì‘ì—…**: $0.03/10,000

**ì˜ˆìƒ ë¹„ìš©**: **$0** (ë¬´ë£Œ í‹°ì–´ ë‚´ ì¶©ë¶„)

### 4.4. Secret ìƒì„±

```bash
# ë°ì´í„°ë² ì´ìŠ¤ ë¹„ë°€ë²ˆí˜¸
echo -n "YOUR_DB_PASSWORD" | gcloud secrets create database-password \
  --data-file=-

# JWT Secret
echo -n "YOUR_JWT_SECRET" | gcloud secrets create jwt-secret \
  --data-file=-

# ë°ì´í„°ë² ì´ìŠ¤ ì‚¬ìš©ì
echo -n "bloguser" | gcloud secrets create database-user \
  --data-file=-

# Secret ëª©ë¡ í™•ì¸
gcloud secrets list

# Cloud Runì— Secret ì ‘ê·¼ ê¶Œí•œ ë¶€ì—¬
gcloud secrets add-iam-policy-binding database-password \
  --member=serviceAccount:YOUR_PROJECT_NUMBER-compute@developer.gserviceaccount.com \
  --role=roles/secretmanager.secretAccessor
```

---

## 5. Container Registry / Artifact Registry

### 5.1. Container Registry (êµ¬ë²„ì „)
- **ë¬´ë£Œ Storage**: ì—†ìŒ (Cloud Storage ë¹„ìš©)
- **Egress**: Cloud Storage ë¹„ìš©

### 5.2. Artifact Registry (ì‹ ë²„ì „, ê¶Œì¥)
- **ë¬´ë£Œ Storage**: 0.5GB/ì›”
- **Egress**: Cloud Storage ë¹„ìš©

**ë¹„ìš© (ì´ˆê³¼ ì‹œ)**:
- **Storage**: $0.10/GB/ì›”

**ì˜ˆìƒ ë¹„ìš©** (ì´ë¯¸ì§€ 2ê°œ, ê° 200MB):
- Storage (0.4GB): **ë¬´ë£Œ**

### 5.3. Artifact Registry ì„¤ì •

```bash
# Artifact Registry í™œì„±í™”
gcloud services enable artifactregistry.googleapis.com

# Docker ì €ì¥ì†Œ ìƒì„±
gcloud artifacts repositories create blog-images \
  --repository-format=docker \
  --location=asia-northeast3 \
  --description="Blog Docker images"

# Docker ì¸ì¦ ì„¤ì •
gcloud auth configure-docker asia-northeast3-docker.pkg.dev

# ì´ë¯¸ì§€ í‘¸ì‹œ
docker tag blog-frontend:latest asia-northeast3-docker.pkg.dev/YOUR_PROJECT_ID/blog-images/frontend:latest
docker push asia-northeast3-docker.pkg.dev/YOUR_PROJECT_ID/blog-images/frontend:latest
```

---

## 6. Cloud CDN (ì½˜í…ì¸  ì „ì†¡)

### 6.1. ì„œë¹„ìŠ¤ ê°œìš”
- **ê¸€ë¡œë²Œ ì—£ì§€ ìºì‹±**
- Egress ë¹„ìš© ì ˆê°
- HTTPS ìë™

### 6.2. ë¹„ìš©
- **Cache Hit**: $0.04/GB (ì•„ì‹œì•„)
- **Cache Fill**: $0.08/GB
- **HTTP ìš”ì²­**: $0.0075/10,000

**ì˜ˆìƒ ë¹„ìš©** (ì›” 100GB íŠ¸ë˜í”½, 80% Cache Hit):
- Cache Hit (80GB): $3.20
- Cache Fill (20GB): $1.60
- ìš”ì²­ (100ë§Œ): $0.75
- **ì´ ë¹„ìš©: ~$5.55**

**vs. Cloud Storage Direct Egress**: $12.00
**ì ˆê°ì•¡**: **$6.45 (54% ì ˆê°)**

### 6.3. CDN ì„¤ì •

```bash
# Load Balancerìš© Backend ìƒì„±
gcloud compute backend-buckets create blog-static \
  --gcs-bucket-name=YOUR_BUCKET_NAME \
  --enable-cdn \
  --cache-mode=CACHE_ALL_STATIC

# CDN ìºì‹œ ì„¤ì •
gcloud compute backend-buckets update blog-static \
  --cache-key-include-host \
  --cache-key-include-protocol \
  --default-ttl=3600 \
  --max-ttl=86400

# ìºì‹œ ë¬´íš¨í™”
gcloud compute url-maps invalidate-cdn-cache blog-cdn \
  --path="/images/*"
```

---

## 7. Cloud Logging & Monitoring

### 7.1. ë¬´ë£Œ í‹°ì–´
- **ë¡œê·¸ ì €ì¥**: 50GB/ì›”
- **ë©”íŠ¸ë¦­**: ë¬´ë£Œ (ê¸°ë³¸ ë©”íŠ¸ë¦­)
- **Alerting**: ë¬´ë£Œ (ê¸°ë³¸ ì•Œë¦¼)

### 7.2. ë¡œê·¸ í™•ì¸

```bash
# Cloud Run ë¡œê·¸ í™•ì¸
gcloud logging read "resource.type=cloud_run_revision AND resource.labels.service_name=blog-backend" \
  --limit 50 \
  --format json

# ì—ëŸ¬ ë¡œê·¸ë§Œ í•„í„°ë§
gcloud logging read "resource.type=cloud_run_revision AND severity>=ERROR" \
  --limit 20

# ì‹¤ì‹œê°„ ë¡œê·¸ ìŠ¤íŠ¸ë¦¬ë°
gcloud logging tail "resource.type=cloud_run_revision"
```

### 7.3. ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ

```bash
# ê¸°ë³¸ ëŒ€ì‹œë³´ë“œëŠ” ìë™ ìƒì„±ë¨
# GCP Console â†’ Monitoring â†’ Dashboards

# Custom ë©”íŠ¸ë¦­ ì¶”ê°€ (ì„ íƒì‚¬í•­)
# Cloud Monitoring API ì‚¬ìš©
```

---

## 8. Cloud Build (CI/CD, ë‹¤ìŒ ë¬¸ì„œì—ì„œ ìƒì„¸)

### 8.1. ë¬´ë£Œ í‹°ì–´
- **ë¹Œë“œ ì‹œê°„**: 120 ë¹Œë“œ-ë¶„/ì¼

### 8.2. ë¹„ìš©
- **ë¹Œë“œ ì‹œê°„ (ì´ˆê³¼)**: $0.003/ë¹Œë“œ-ë¶„

**ì˜ˆìƒ ë¹„ìš©**: **$0** (ë¬´ë£Œ í‹°ì–´ ë‚´)

---

## 9. ì´ ë¹„ìš© ì‹œë®¬ë ˆì´ì…˜

### 9.1. ì‹œë‚˜ë¦¬ì˜¤: ê°œì¸ ë¸”ë¡œê·¸ (ì›” 5,000 ë°©ë¬¸ì)

| ì„œë¹„ìŠ¤ | ë¬´ë£Œ í‹°ì–´ | ì‚¬ìš©ëŸ‰ | ë¹„ìš© |
|--------|-----------|--------|------|
| **Cloud Run (Frontend)** | 180k vCPU-ì´ˆ | 30k vCPU-ì´ˆ | $0 |
| **Cloud Run (Backend)** | 180k vCPU-ì´ˆ | 20k vCPU-ì´ˆ | $0 |
| **Cloud SQL (db-f1-micro)** | 90ì¼ ë¬´ë£Œ | 1 instance | $0 (90ì¼ í›„ $10) |
| **Cloud Storage** | 5GB | 3GB | $0 |
| **Artifact Registry** | 0.5GB | 0.4GB | $0 |
| **Secret Manager** | 6 secrets | 4 secrets | $0 |
| **Cloud CDN** | - | 20GB | $1.50 |
| **Cloud Logging** | 50GB | 5GB | $0 |
| **Cloud Build** | 120ë¶„/ì¼ | 10ë¶„/ì¼ | $0 |
| **Egress (CDN ì‚¬ìš©)** | - | 100GB | $4.00 |
| **ì´ ë¹„ìš©** | | | **$5.50/ì›”** |

**90ì¼ ë¬´ë£Œ í‹°ì–´ ì¢…ë£Œ í›„**: **$15.50/ì›”**

### 9.2. ì‹œë‚˜ë¦¬ì˜¤: ì¤‘ê¸‰ ë¸”ë¡œê·¸ (ì›” 50,000 ë°©ë¬¸ì)

| ì„œë¹„ìŠ¤ | ì‚¬ìš©ëŸ‰ | ë¹„ìš© |
|--------|--------|------|
| **Cloud Run (Frontend)** | 300k vCPU-ì´ˆ | $2.00 |
| **Cloud Run (Backend)** | 200k vCPU-ì´ˆ | $1.50 |
| **Cloud SQL (db-g1-small)** | 1 instance | $27.00 |
| **Cloud Storage** | 10GB | $0.20 |
| **Cloud CDN** | 500GB | $25.00 |
| **ì´ ë¹„ìš©** | | **$55.70/ì›”** |

---

## 10. ë¹„ìš© ìµœì í™” ì „ëµ

### 10.1. Cloud Run ìµœì í™”
```bash
# Min instances = 0 (Cold Start í—ˆìš©)
# CPU Throttling í™œì„±í™” (ìš”ì²­ ì—†ì„ ë•Œ CPU ì‚¬ìš© ì•ˆí•¨)
# ì ì ˆí•œ ë©”ëª¨ë¦¬ í• ë‹¹ (512Mië©´ ì¶©ë¶„)
```

### 10.2. Cloud SQL ìµœì í™”
```bash
# ê°œë°œ: db-f1-micro ì‚¬ìš©
# í”„ë¡œë•ì…˜: db-g1-small ì‚¬ìš©
# ì•¼ê°„/ì£¼ë§: ì¸ìŠ¤í„´ìŠ¤ ì¤‘ì§€ (ê°œë°œ í™˜ê²½)

# ìë™ ìŠ¤ì¼€ì¤„ë§ (ì„ íƒì‚¬í•­)
gcloud scheduler jobs create http stop-db \
  --schedule="0 22 * * *" \
  --uri="https://sqladmin.googleapis.com/sql/v1beta4/projects/YOUR_PROJECT/instances/blog-db/stop" \
  --http-method=POST
```

### 10.3. Storage ìµœì í™”
```bash
# Lifecycle policy: 90ì¼ í›„ Nearline
# CDN í™œì„±í™” (Egress ë¹„ìš© ì ˆê°)
# ì´ë¯¸ì§€ ì••ì¶• (WebP, AVIF)
```

### 10.4. ì˜ˆì‚° ì•Œë¦¼ ì„¤ì •
```bash
# GCP Console â†’ Billing â†’ Budgets
# ì›” $20 ì´ˆê³¼ ì‹œ ì´ë©”ì¼ ì•Œë¦¼ ì„¤ì •
```

---

## 11. ë¦¬ì „ ì„ íƒ

### 11.1. ê¶Œì¥ ë¦¬ì „
- **asia-northeast3** (ì„œìš¸) - í•œêµ­ ì‚¬ìš©ì ëŒ€ìƒ
- **asia-northeast1** (ë„ì¿„) - ì„œìš¸ ë¯¸ì§€ì› ì„œë¹„ìŠ¤
- **us-central1** (ì•„ì´ì˜¤ì™€) - ê°€ì¥ ì €ë ´ (ë¯¸êµ­ ëŒ€ìƒ)

### 11.2. ë¦¬ì „ë³„ ë¹„ìš© ì°¨ì´
- **ì„œìš¸ (asia-northeast3)**: 100% ê¸°ì¤€
- **ë„ì¿„ (asia-northeast1)**: 95%
- **ì•„ì´ì˜¤ì™€ (us-central1)**: 80%

**ê¶Œì¥**: í•œêµ­ ì‚¬ìš©ìê°€ ë§ë‹¤ë©´ ì„œìš¸, ê¸€ë¡œë²Œì´ë©´ ë¯¸êµ­

---

## 12. ë³´ì•ˆ ì„¤ì •

### 12.1. IAM ìµœì†Œ ê¶Œí•œ ì›ì¹™
```bash
# Cloud Runì— Cloud SQL ì ‘ê·¼ ê¶Œí•œë§Œ ë¶€ì—¬
gcloud projects add-iam-policy-binding YOUR_PROJECT_ID \
  --member=serviceAccount:YOUR_SERVICE_ACCOUNT \
  --role=roles/cloudsql.client
```

### 12.2. VPC ë„¤íŠ¸ì›Œí¬
```bash
# Serverless VPC Connector (Cloud Run â†” Cloud SQL Private IP)
gcloud compute networks vpc-access connectors create blog-connector \
  --network=default \
  --region=asia-northeast3 \
  --range=10.8.0.0/28
```

### 12.3. Cloud Armor (DDoS ë°©ì–´, ì„ íƒì‚¬í•­)
```bash
# Security Policy ìƒì„±
gcloud compute security-policies create blog-security-policy

# Rate Limiting ê·œì¹™ (ì´ˆë‹¹ 100 ìš”ì²­)
gcloud compute security-policies rules create 1000 \
  --security-policy=blog-security-policy \
  --expression="true" \
  --action=rate-based-ban \
  --rate-limit-threshold-count=100 \
  --rate-limit-threshold-interval-sec=60
```

---

## ì²´í¬ë¦¬ìŠ¤íŠ¸

### ì´ˆê¸° ì„¤ì •
- [ ] GCP í”„ë¡œì íŠ¸ ìƒì„±
- [ ] Billing í™œì„±í™”
- [ ] í•„ìš”í•œ API í™œì„±í™”
- [ ] ë¦¬ì „ ì„ íƒ (asia-northeast3 ê¶Œì¥)

### Cloud Run
- [ ] Frontend ì„œë¹„ìŠ¤ ë°°í¬
- [ ] Backend ì„œë¹„ìŠ¤ ë°°í¬
- [ ] Auto-scaling ì„¤ì •
- [ ] í™˜ê²½ë³€ìˆ˜ ì„¤ì •

### Cloud SQL
- [ ] PostgreSQL ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
- [ ] ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±
- [ ] ì‚¬ìš©ì ìƒì„±
- [ ] ë°±ì—… ì„¤ì •

### Cloud Storage
- [ ] ë²„í‚· ìƒì„±
- [ ] Public ì•¡ì„¸ìŠ¤ ì„¤ì •
- [ ] CORS ì„¤ì •
- [ ] Lifecycle ì •ì±… ì„¤ì •

### Secret Manager
- [ ] ë°ì´í„°ë² ì´ìŠ¤ ë¹„ë°€ë²ˆí˜¸ ì €ì¥
- [ ] JWT Secret ì €ì¥
- [ ] IAM ê¶Œí•œ ë¶€ì—¬

### ëª¨ë‹ˆí„°ë§
- [ ] ë¡œê¹… í™•ì¸
- [ ] ë©”íŠ¸ë¦­ ëŒ€ì‹œë³´ë“œ ì„¤ì •
- [ ] ì˜ˆì‚° ì•Œë¦¼ ì„¤ì •

---

ì´ì œ GCP ì¸í”„ë¼ êµ¬ì¶•ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤! ë‹¤ìŒ ë‹¨ê³„ëŠ” CI/CD íŒŒì´í”„ë¼ì¸ êµ¬ì¶•ì…ë‹ˆë‹¤. ğŸš€
